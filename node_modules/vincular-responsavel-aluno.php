<?php
	require_once("Conexao.php");
	require_once("config.php");

    try
	{
		$responsavelPeloAlunoID = $_SESSION['responsavelPeloAlunoID'];
		$cpf = $_POST['cpf'];
		$parentescoSelecionado = $_POST['parentescoSelecionado'];
		
		$query = "	UPDATE responsavel_pelo_aluno 
					SET responsavel_cpf = :cpf, parentesco_responsavel = :parentescoSelecionado
					WHERE id_responsavel_pelo_aluno = :responsavelPeloAlunoID";
					
		$conexao = Conexao::pegarConexao();
		$stmt = $conexao->prepare($query);
		
		$stmt->bindValue(':cpf', $cpf);
		$stmt->bindValue(':parentescoSelecionado', $parentescoSelecionado);
		$stmt->bindValue(':responsavelPeloAlunoID', $responsavelPeloAlunoID);

		$stmt->execute();

		return "Cadastrado";
	}
	
	catch (Exception $e)
	{
		//Erro::trataErro($e);
		$response['code'] = 'erro';
		$response['title'] = "Este CPF já foi cadastrado!";
		$response['text'] = (string) $e; //Apresenta o erro no banco de dados
		//$response['text'] = "Por favor, cadastre um número de CPF diferente.";
		echo json_encode($response);
	}